\documentclass[a4paper, 12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsfonts}
\usepackage{amsmath} 
\usepackage{mathtools}
\usepackage{indentfirst} 

\usepackage{geometry} % Меняем поля страницы
\geometry{left=2cm}% левое поле
\geometry{right=1.5cm}% правое поле
\geometry{top=1.5cm}% верхнее поле
\geometry{bottom=3cm}% нижнее поле

\begin{document}
	% Титульный лист
	\begin{titlepage}
		\begin{center}
			Санкт-Петербургский политехнический университет Петра Великого \\ Физико-механический институт \\ Высшая школа прикладной математики и вычислительной физики
		\end{center}
		\vspace{10em}
		\begin{center}
			\Large Отчет по лабораторной работе №4 \\ по дисциплине "Численные методы"
		\end{center}
		\vspace{1em}
		\begin{center}
			\Huge Вычисление определенного интеграла с помощью квадратурных формул. Формула Гаусса для 3 слагаемых.
		\end{center}
		\vspace{15em}
		{\Large 
			
			Выполнил: студент гр. 5030102/00003 Красников Р.А.
			\vspace{1em}
			
			Преподаватель: Добрецова С.Б.}
		\vspace{\fill}
		\begin{center}
			Санкт-Петербург \\ 2022
		\end{center}
	\end{titlepage}
	\newpage
	
	\section{Формулировка и формализация задачи.}
	
	\subsection{Формулировка задачи.}
	
	Вычислить определенный интеграл заданной функции на отрезке.
	
	Построить графики зависимости фактической ошибки и числа итераций (число разбиений отрезка) от заданной точности.
	
	Построить функцию с разрывом первой производной и исследовать для нее аналогичные зависимости.
	
	\subsection{Постановка задачи.}
	
	Дана функция $f\in C(a,b)$ такая, что $\int\limits_a^bf(x)dx<\infty$, и точность $\epsilon$. 
	
	Найти число $I$ такое, что $|I-\int\limits_a^bf(x)dx|<\epsilon$.
	
	\section{Алгоритм и условия его применимости.}
	
	\subsection{Алгоритм вычисления определенного интеграла по формуле трех восьмых.}
	\label{alghorithm}
	
	\begin{enumerate}
		\item Ввести функцию $f$, отрезок $[a,b]$, точность $\epsilon$.
		\item Положить $m=1$ -- число отрезков разбиения
		\item Вычислить $I_m$ по формуле
		\begin{equation} \label{method}
			I_m=\frac{h}{18}\sum\limits_{i=1}^{m}\bigg(5f\bigg(\frac{x_i+x_{i-1}}{2}-\frac{h}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{x_i+x_{i-1}}{2}\bigg)+5f\bigg(\frac{x_i+x_{i-1}}{2}+\frac{h}{2}\sqrt{0,6}\bigg)\bigg),
		\end{equation}
		где, $h=\dfrac{b-a}{m}$, $x_i=a+ih$, $i=\overline{0,m}$.
		\item Вычислить $I_{2m}$ по формуле \eqref{method}.
		\item Если
		\begin{equation}
			|I_m-I_{2m}|<31\epsilon
		\end{equation}
		то закончить вычисления и положить $I=I_{2m}$ -- искомое значение интеграла с точностью $\epsilon$; иначе положить $m=2m$ и вернуться к шагу 4.
	\end{enumerate}

	\subsection{Построение формулы \eqref{method}.}
	
	Зададимся задачей построения квадратурной формулы Гаусса
	\begin{equation} \label{generalformula}
		\int\limits_{-1}^{1}f(x)dx=A_1f(x_1)+A_2f(x_2)+A_3f(x_3)
	\end{equation}
	
	Для любой определенной и интегрируемой на отрезке $[-1,1]$ функции $f$ имеет место соотношение
	\begin{equation} \label{symproof}
		\int\limits_{-1}^{1}f(x)dx=\int\limits_{-1}^{1}f(-x)dx=A_3f(-x_3)+A_2f(-x_2)+A_1f(-x_1)
	\end{equation}
	
	Сравнивая соотношение \eqref{symproof} с формулой \eqref{generalformula}, получаем следующую симметрию
	\begin{equation} \label{symmetry}
		\begin{gathered}
			A_3=A_1,\\
			x_3=-x_1,\\
			x_2=0
		\end{gathered}
	\end{equation}

	Запишем систему определяющих уравнений
	\begin{equation}
		\begin{cases}
			\displaystyle
			A_1+A_2+A_3=\int\limits_{-1}^1dx=2\\
			\displaystyle
			A_1x_1+A_2x_2+A_3x_3=\int\limits_{-1}^1xdx=0\\
			\displaystyle
			A_1x_1^2+A_2x_2^2+A_3x_3^2=\int\limits_{-1}^1x^2dx=\frac{2}{3}\\
			\displaystyle
			A_1x_1^3+A_2x_2^3+A_3x_3^3=\int\limits_{-1}^1x^3dx=0\\
			\displaystyle
			A_1x_1^4+A_2x_2^4+A_3x_3^4=\int\limits_{-1}^1x^4dx=\frac{2}{5}\\
			\displaystyle
			A_1x_1^5+A_2x_2^5+A_3x_3^5=\int\limits_{-1}^1x^5dx=0
		\end{cases}
	\end{equation}

	Используем симметрию \eqref{symmetry}, при этом 2,4,6-ое уравнения вырождаются в тождества
	
	\begin{equation}
		\begin{cases}
			2A_1+A_2=2 \\
			\displaystyle \vspace{0.5em}
			A_1x_1^2=\frac{1}{3} \\
			\displaystyle
			A_1x_1^4=\frac{1}{5}
		\end{cases}
	\end{equation}

	Из второго уравнения имеем $x_1^4=\dfrac{1}{9A_1^2}$ и подставляя это выражение в третье уравнение получаем
	
	\begin{equation}
		\begin{gathered}
			A_1=A_3=\frac{5}{9},\\
			A_2=2(1-A_1)=\frac{8}{9},\\
			x_1=-\sqrt{\frac{1}{3A_1}}=-\sqrt{\frac{3}{5}},\\
			x_2=0,\\
			x_3=-x_1=\sqrt{\frac{3}{5}}
		\end{gathered}
	\end{equation}

	Таким образом, получена квадратурная формула Гаусса для интегрирования по отрезку $[-1,1]$. Применим ее для вычисления интеграла по произвольному отрезку $[a,b]$:
	\begin{equation} \label{methodab}
		\begin{gathered}
			\int\limits_a^bf(x)dx=\bigg[x=\frac{a+b}{2}+\frac{b-a}{2}t,\ dx=\frac{b-a}{2}dt\bigg]=\frac{b-a}{2}\int\limits_{-1}^1f\bigg(\frac{a+b}{2}+\frac{b-a}{2}t\bigg)dt=\\=
			\frac{b-a}{18}\bigg(5f\bigg(\frac{a+b}{2}-\frac{b-a}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{a+b}{2}\bigg)+5f\bigg(\frac{a+b}{2}+\frac{b-a}{2}\sqrt{0,6}\bigg)\bigg)
		\end{gathered}
	\end{equation}

	Применяя формулу \eqref{methodab} на каждом из отрезков разбиения и суммируя приближенные значения интегралов по этим отрезкам получаем формулу \eqref{method}.
	
	\subsection{Условия применимости метода вычисления определенного интеграла по формуле трех восьмых.}
	
	\begin{enumerate}
		\item Функция $f$ определена и интегрируема на $[a,b]$.
	\end{enumerate}
	
	\section{Анализ задачи.}
	
	Для выполнения работы мне была предложена функция
	\begin{equation} \label{f}
		f(x)=(x^5-5,2x^3+5,5x^2-7x-3,5)cos(0,4x), x\in[-3,0;0,7]
	\end{equation}
	
	\subsection{Проверка существования и единственности решения.}
	\label{solexistance}
	
	Функция $f$, заданная формулой \eqref{f} непрерывна на любом отрезке $[a,b]$, а значит интегрируема по любому отрезку $[a,b]$, поэтому решение существует.
	
	Определенный интеграл функции $f$, интегрируемой на отрезке $[a,b]$, по отрезку $[a,b]$ единствен.
	
	\section{Проверка условий применимости метода вычисления определенного интеграла по формуле трех восьмых.}
	
	\begin{enumerate}
		\item Функция $f$, заданная формулой \eqref{f}, определена и интегрируема на отрезке $[-3,0;0,7]$. (см. пункт \ref{solexistance})
	\end{enumerate}
	
	Условия применимости метода вычисления определенного интеграла по формуле Гаусса выполнены.
	
	\section{Тестовый пример.}
	
	Для демонстрации метода вычисления определенного интеграла по формуле Гаусса применим алгоритм из пункта \ref{alghorithm} для вычисления определенного интеграла
	\begin{equation}
		I=\int\limits_1^{13}\frac{dx}{x^2}=-\frac{1}{x}\bigg|_1^{13}=\frac{12}{13}\approx0,9231
	\end{equation}

	Во введенных обозначениях:
	\begin{equation*}
		\begin{gathered}
		f(x)=\frac{1}{x^2},\\
		a=1, b=13
		\end{gathered}
	\end{equation*}
	
	Итерации алгоритма:
	\begin{enumerate}
		\item $m=1$:
		\begin{equation*}
			\begin{gathered}
				h=\frac{b-a}{n}=\frac{13-1}{1}=12,\\
				x_i=a+ih=1+4i, i=\overline{0,1},\\
				x^h=\{1,13\},\\
				I_1=\frac{12}{18}\bigg(5f\bigg(\frac{1+13}{2}-\frac{12}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{1+13}{2}\bigg)+5f\bigg(\frac{1+13}{2}+\frac{12}{2}\sqrt{0,6}\bigg)\bigg)=\\=0,7358
			\end{gathered}
		\end{equation*}
		\item $m=2$:
		\begin{equation*}
			\begin{gathered}
				h=\frac{b-a}{n}=\frac{13-1}{2}=6,\\
				x_i=a+ih=1+2i, i=\overline{0,2},\\
				x^h=\{1,7,13\},\\
				\begin{aligned}
					I_2&=\frac{6}{18}\bigg(5f\bigg(\frac{1+7}{2}-\frac{6}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{1+7}{2}\bigg)+5f\bigg(\frac{1+7}{2}+\frac{6}{2}\sqrt{0,6}\bigg)+\\&+5f\bigg(\frac{7+13}{2}-\frac{6}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{7+13}{2}\bigg)+5f\bigg(\frac{7+13}{2}+\frac{6}{2}\sqrt{0,6}\bigg)\bigg)=
				\end{aligned}\\
				=0,8675
			\end{gathered}
		\end{equation*}
		\item $m=4$:
		\begin{equation*}
			\begin{gathered}
				h=\frac{b-a}{n}=\frac{13-1}{4}=3,\\
				x_i=a+ih=1+i, i=\overline{0,4},\\
				x^h=\{1,4,7,10,13\},\\
				\begin{aligned}
					I_4&=\frac{3}{18}\bigg(5f\bigg(\frac{1+4}{2}-\frac{3}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{1+4}{2}\bigg)+5f\bigg(\frac{1+4}{2}+\frac{3}{2}\sqrt{0,6}\bigg)+\\&+5f\bigg(\frac{4+7}{2}-\frac{3}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{4+7}{2}\bigg)+5f\bigg(\frac{4+7}{2}+\frac{3}{2}\sqrt{0,6}\bigg)+\\&+5f\bigg(\frac{7+10}{2}-\frac{3}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{7+10}{2}\bigg)+5f\bigg(\frac{7+10}{2}+\frac{3}{2}\sqrt{0,6}\bigg)+\\&+5f\bigg(\frac{10+13}{2}-\frac{3}{2}\sqrt{0,6}\bigg)+8f\bigg(\frac{10+13}{2}\bigg)+5f\bigg(\frac{10+13}{2}+\frac{3}{2}\sqrt{0,6}\bigg)\bigg)=
				\end{aligned}\\
				=0,9140
			\end{gathered}
	\end{equation*}
	\end{enumerate}
	
	Приближенные значения ошибок, вычисленные по правилу Рунге:
	\begin{equation*}
		\begin{aligned}
			&|I-I_2|\approx\frac{|I_1-I_2|}{31}=0,0042,\\
			&|I-I_4|\approx\frac{|I_2-I_4|}{31}=0,0015
		\end{aligned}
	\end{equation*}

	Фактические значения ошибок:
	\begin{equation*}
		\begin{aligned}
			&|I-I_2|=0,0466,\\
			&|I-I_4|=0,0091
		\end{aligned}
	\end{equation*}

	В лабораторной работе №3 ошибки вычисления интеграла по формуле трех восьмых оказались следующими:
	\begin{equation*}
		\begin{aligned}
			&|I-I_2^{(3/8)}|=0,2485,\\
			&|I-I_4^{(3/8)}|=0,0470
		\end{aligned}
	\end{equation*}
	Видим, что формула Гаусса при меньшем на 1 количестве вычислений значения функции $f$ дала значение интеграла точнее примерно на порядок.
	
	\section{Подготовка контрольных тестов.}
	
	Для построения графиков зависимостей фактической ошибки и числа итераций (число разбиений отрезка) от заданной точности были выбраны значения точности $\epsilon_i=10^{-i}, i=\overline{1,12}$. 
	
	\section{Модульная структура программы.}
	Для проведения исследования была написана программа на языке C++, состоящая из следующих функций:
	\begin{itemize}
		\item GaussIntegral(вх.: функция $f$, отрезок $[a,b]$, число отрезков разбиения $m$; вых.: число $I_m$) -- вычисляет значение квадратурной формулы \eqref{method} для заданного числа отрезков разбиения $m$.
		\item EvaluateIntegralWithRungesAccuracy(вх.: функция $f$, отрезок $[a,b]$, точность $\epsilon$; вых.: числа $I, I_R$, число итераций $q$) -- вычисляет по алгоритму \ref{alghorithm} приближенное значение интеграла $I\approx\int\limits_a^bf(x)dx$ и его уточненное с помощью поправки Ричардсона значение $I_R$, применяя для апостериорной оценки погрешности правило Рунге.
	\end{itemize}
	
	\section{Анализ результатов.}
	
	\subsection{Анализ зависимости фактической ошибки от заданной точности.} 
	
	На графике зависимости фактической ошибки от заданной точности видим, что линия фактической ошибки выглядит как "ступеньки"\,,\ то есть ошибка с уменьшением $\epsilon$ несколько удаляется от биссектрисы, затем выходит на горизонталь и после касания биссектрисы снова продолжает от нее отдаляться. Линия фактической ошибки лежит ниже биссектрисы первой координатной четверти -- это означает, что для данной задачи правило Рунге позволяет получать значение определенного интеграла с наперед заданной точностью так, чтобы фактическая ошибка оказалась гарантированно меньше чем задаваемая точность. 
	
	\subsection{Анализ зависимости числа итераций от заданной точности.}
	
	На графике зависимости числа итераций от заданной точности видим, что число итераций алгоритма \ref{alghorithm} почти линейно зависит от порядка заданной точности. Для точностей $10^{-6},10^{-5}$ и $10^{-12},10^{-11}$ количество итераций составляет 6 и 11 соответственно -- именно в этих местах линейность нарушается, поскольку для этих точностей линия числа итераций выходит на горизонталь.
	
	\section{Выводы.}
	
	\begin{itemize}
		\item 
	\end{itemize}
	
\end{document}