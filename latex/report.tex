\documentclass[a4paper, 12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsfonts}
\usepackage{amsmath} 
\usepackage{mathtools}
\usepackage{indentfirst} 

\usepackage{geometry} % Меняем поля страницы
\geometry{left=2cm}% левое поле
\geometry{right=1.5cm}% правое поле
\geometry{top=1.5cm}% верхнее поле
\geometry{bottom=3cm}% нижнее поле

\begin{document}
	% Титульный лист
	\begin{titlepage}
		\begin{center}
			Санкт-Петербургский политехнический университет Петра Великого \\ Физико-механический институт \\ Высшая школа прикладной математики и вычислительной физики
		\end{center}
		\vspace{10em}
		\begin{center}
			\Large Отчет по лабораторной работе №3 \\ по дисциплине "Численные методы"
		\end{center}
		\vspace{1em}
		\begin{center}
			\Huge Вычисление определенного интеграла с помощью квадратурных формул Ньютона-Котеса. Формула трех восьмых.
		\end{center}
		\vspace{15em}
		{\Large 
			
			Выполнил: студент гр. 5030102/00003 Красников Р.А.
			\vspace{1em}
			
			Преподаватель: Добрецова С.Б.}
		\vspace{\fill}
		\begin{center}
			Санкт-Петербург \\ 2022
		\end{center}
	\end{titlepage}
	\newpage
	
	\section{Формулировка и формализация задачи.}
	
	\subsection{Формулировка задачи.}
	
	Вычислить определенный интеграл заданной функции на отрезке.
	
	Построить графики зависимости фактической ошибки и числа итераций (число разбиений отрезка) от заданной точности и график зависимости фактической ошибки от длины отрезка разбиения.
	
	Исследуя последний график, определить порядок точности применяемой формулы и вычислить константу.
	
	Для заданной функции найти выражение для теоретической ошибки при помощи нужных производных и построить на графике для ошибок линии, соответствующие максимальной и минимальной теоретической ошибке.
	
	\subsection{Постановка задачи.}
	
	Дана функция $f\in C(a,b)$ такая, что $\int\limits_a^bf(x)dx<\infty$, и точность $\epsilon$. 
	
	Найти число $I$ такое, что $|I-\int\limits_a^bf(x)dx|<\epsilon$.
	
	\section{Алгоритм и условия его применимости.}
	
	\subsection{Алгоритм вычисления определенного интеграла по формуле трех восьмых.}
	\label{alghorithm}
	
	\begin{enumerate}
		\item Ввести функцию $f$, отрезок $[a,b]$, точность $\epsilon$.
		\item Положить $m=1$ -- число отрезков разбиения
		\item Вычислить $I_m$ по формуле
		\begin{equation} \label{method}
			I_m=\frac{3h}{8}\bigg(f(x_0)+3f(x_{n-2})+3f(x_{n-1})+f(x_n)+\sum\limits_{i=1}^{\frac{n}{3}-1}(3f(x_{3i-2})+3f(x_{3i-1})+2f(x_{3i}))\bigg),
		\end{equation}
		где $n=3m$, $h=\dfrac{b-a}{n}$, $x_i=a+ih$.
		\item Вычислить $I_{2m}$ по формуле \eqref{method}.
		\item Если
		\begin{equation}
			|I_m-I_{2m}|<15\epsilon
		\end{equation}
		то закончить вычисления и положить $I=I_{2m}$ -- искомое значение интеграла с точностью $\epsilon$; иначе положить $m=2m$ и вернуться к шагу 4.
	\end{enumerate}
	
	\subsection{Условия применимости метода вычисления определенного интеграла по формуле трех восьмых.}
	
	\begin{enumerate}
		\item Функция $f$ определена и интегрируема на $[a,b]$.
	\end{enumerate}
	
	\section{Анализ задачи.}
	
	Для выполнения работы мне была предложена функция
	\begin{equation} \label{f}
		f(x)=x^5-5,2x^3+5,5x^2-7x-3,5, x\in[-3,0;0,7]
	\end{equation}
	
	Оценим фактическую ошибку пользуясь формулой для теоретической ошибки значения определенного интеграла функции $f$, вычисленного по отрезку $[a,b]$
	\begin{equation}
		\exists\xi\in[a,b]:|I-I_m|=\frac{(b-a)^5}{6480m^4}|f^{(4)}(\xi)|
	\end{equation}
	Заменим $|f^{(4)}(\xi)|$ соответствующими оценками:
	\begin{equation} \label{theor_est}
		r_m=\frac{(b-a)^5}{6480m^4}m_4 \leq |I-I_m| \leq \frac{(b-a)^5}{6480m^4}M_4=R_m,
	\end{equation}
	где $m_4=\min\limits_{x\in[a,b]}|f^{(4)}(x)|$, $M_4=\max\limits_{x\in[a,b]}|f^{(4)}(x)|$.
	
	Для заданной формулой \eqref{f} функции $f$ имеем
	\begin{equation*} 
		\begin{gathered}
			b-a=3,7,\\
			|f^{(4)}(x)|=120|x|,\\
			m_4=\min\limits_{x\in[-3,0;0,7]}120|x|=0,\\
			M_4=\max\limits_{x\in[-3,0;0,7]}120|x|=360
		\end{gathered}
	\end{equation*}
	и соответствующие оценки фактической ошибки:
	\begin{equation} \label{final_est}
		0 \leq |I-I_m| \leq \frac{(3,7)^5}{18m^4}=\frac{3,7}{18}H^4,
	\end{equation}
	где $H=\dfrac{b-a}{m}$.
	
	\subsection{Проверка существования и единственности решения.}
	\label{solexistance}
	
	Функция $f$, заданная формулой \eqref{f} -- полином. Любой полином интегрируем по любому отрезку $[a,b]$, поэтому решение существует.
	
	Определенный интеграл функции $f$, интегрируемой на отрезке $[a,b]$, по отрезку $[a,b]$ единствен.
	
	\section{Проверка условий применимости метода вычисления определенного интеграла по формуле трех восьмых.}
	
	\begin{enumerate}
		\item Функция $f$, заданная формулой \eqref{f}, определена и интегрируема на отрезке $[-3,0;0,7]$. (см. пункт \ref{solexistance})
	\end{enumerate}
	
	Условия применимости метода вычисления определенного интеграла по формуле трех восьмых выполнены.
	
	\section{Тестовый пример.}
	
	Для демонстрации метода вычисления определенного интеграла по формуле трех восьмых применим алгоритм из пункта \ref{alghorithm} для вычисления определенного интеграла
	\begin{equation}
		I=\int\limits_1^{13}\frac{dx}{x^2}=-\frac{1}{x}\bigg|_1^{13}=\frac{12}{13}\approx0,9231
	\end{equation}

	Во введенных обозначениях:
	\begin{equation*}
		\begin{gathered}
		f(x)=\frac{dx}{x^2},\\
		a=1, b=13
		\end{gathered}
	\end{equation*}
	
	Итерации алгоритма:
	\begin{enumerate}
		\item $m=1$:
		\begin{equation*}
			\begin{gathered}
				n=3m=3,\\
				h=\frac{b-a}{n}=\frac{13-1}{3}=4,\\
				x_i=a+ih=1+4i, i=\overline{0,3},\\
				x^h=\{1,5,9,13\},\\
				\begin{aligned}
					I_1&=\frac{3\cdot4}{8}(f(1)+3f(5)+3f(9)+f(13))=\\&=\frac{3\cdot4}{8}(1+3\cdot0,04+3\cdot0,0123+0,0059)=1,7442
				\end{aligned}
			\end{gathered}
		\end{equation*}
		\item $m=2$:
		\begin{equation*}
			\begin{gathered}
				n=3m=6,\\
				h=\frac{b-a}{n}=\frac{13-1}{6}=2,\\
				x_i=a+ih=1+2i, i=\overline{0,6},\\
				x^h=\{1,3,5,7,9,11,13\},\\
				\begin{aligned}
					I_2&=\frac{3\cdot2}{8}(f(1)+3f(3)+3f(5)+2f(7)+3f(9)+3f(11)+f(13))=\\&=\frac{3\cdot2}{8}(1+3\cdot0,1111+3\cdot0,04+2\cdot0,0204+3\cdot0,0123+3\cdot0,0083+0,0059)=1,1716
				\end{aligned}
			\end{gathered}
		\end{equation*}
		\item $m=4$:
		\begin{equation*}
			\begin{gathered}
				n=3m=12,\\
				h=\frac{b-a}{n}=\frac{13-1}{6}=1,\\
				x_i=a+ih=1+i, i=\overline{0,12},\\
				x^h=\{1,2,3,4,5,6,7,8,9,10,11,12,13\},\\
				\begin{aligned}
					I_4&=\frac{3\cdot1}{8}(f(1)+3f(2)+3f(3)+2f(4)+3f(5)+3f(6)+2f(7)+\\&+3f(8)+3f(9)+2f(10)+3f(11)+3f(12)+f(13))=\\&=\frac{3\cdot1}{8}(1+3\cdot0,25+3\cdot0,1111+2\cdot0,0625+3\cdot0,04+3\cdot0,0278+2\cdot0,0204+\\&+3\cdot0,0156+3\cdot0,0123+2\cdot0,01+3\cdot0,0083+3\cdot0,0069+0,0059)=0,9701
				\end{aligned}
			\end{gathered}
	\end{equation*}
	\end{enumerate}
	
	Приближенные значения ошибок, вычисленные по правилу Рунге:
	\begin{equation*}
		\begin{aligned}
			&|I-I_2|\approx\frac{|I_1-I_2|}{15}=0,0382,\\
			&|I-I_4|\approx\frac{|I_2-I_4|}{15}=0,0134
		\end{aligned}
	\end{equation*}

	Фактические значения ошибок:
	\begin{equation*}
		\begin{aligned}
			&|I-I_2|=0,2485,\\
			&|I-I_4|=0,0470
		\end{aligned}
	\end{equation*}
	
	\section{Подготовка контрольных тестов.}
	
	Для построения графиков зависимостей фактической ошибки и числа итераций (число разбиений отрезка) от заданной точности были выбраны значения точности $\epsilon_i=10^{-i}, i=\overline{1,12}$. 
	
	Для построения графика зависимости фактической ошибки от длины отрезка разбиения были выбраны значения длин $H=2^{-i}(b-a), i=\overline{0,11}$. В этом выражении числу $i$ соответствует $m=2^{i}$ отрезков разбиения, а само число $i$ в точности количество "итераций" алгоритма \ref{alghorithm}. С учетом этого выражения для данного эксперимента оценка \eqref{final_est} преобразуется в
	\begin{equation}
		0 \leq |I-I_{2^i}| \leq \frac{(3,7)^5}{18}\cdot2^{-4i}, i=\overline{0,11}
	\end{equation}
	
	\section{Модульная структура программы.}
	Для проведения исследования была написана программа на языке C++, состоящая из следующих функций:
	\begin{itemize}
		\item CubicNewtonCotesIntegral(вх.: функция $f$, отрезок $[a,b]$, число отрезков разбиения $m$; вых.: число $I_m$) -- вычисляет значение квадратурной формулы \eqref{method} для заданного числа отрезков разбиения $m$.
		\item EvaluateIntegralWithRungesAccuracy(вх.: функция $f$, отрезок $[a,b]$, точность $\epsilon$; вых.: число $I$) -- вычисляет по алгоритму \ref{alghorithm} приближенное значение интеграла $I\approx\int\limits_a^bf(x)dx$, применяя для апостериорной оценки погрешности правило Рунге.
		\item TheoreticError(вх.: отрезок $[a,b]$, число отрезков разбиения $m$, числа $m_4,M_4$, вых.: оценки ошибки $r_m,R_m$) -- для заданного числа отрезков разбиения $m$ вычисляет теоретические оценки снизу $r_m$ и сверху $R_m$ фактической ошибки по формуле \eqref{theor_est}.
	\end{itemize}
	
	\section{Анализ результатов.}
	
	\subsection{Анализ зависимости фактической ошибки от заданной точности.} 
	
	На графике зависимости фактической ошибки от заданной точности видим, что линия фактической ошибки выглядит как "ступеньки", то есть ошибка с уменьшением $\epsilon$ несколько удаляется от биссектрисы, затем выходит на горизонталь и после касания биссектрисы снова продолжает от нее отдаляться. Линия фактической ошибки лежит ниже биссектрисы первой координатной четверти -- это означает, что для данной задачи правило Рунге позволяет получать значение определенного интеграла с наперед заданной точностью так, чтобы фактическая ошибка оказалась гарантированно меньше чем задаваемая точность. 
	
	\subsection{Анализ зависимости числа итераций от заданной точности.}
	
	На графике зависимости числа итераций от заданной точности видим, что число итераций алгоритма \ref{alghorithm} почти линейно зависит от порядка заданной точности. Для точностей $10^{-6},10^{-5}$ и $10^{-12},10^{-11}$ количество итераций составляет 6 и 11 соответственно -- именно в этих местах линейность нарушается, поскольку для этих точностей линия числа итераций выходит на горизонталь.
	
	\subsection{Анализ зависимости фактической ошибки от длины отрезка разбиения.}
	
	На графике зависимости фактической ошибки от длины отрезка разбиения видим, что линия ошибки представляет собой прямую (в логарифмических осях). Уменьшению на 1 порядок длины отрезка разбиения соответствует уменьшение на 4 порядка фактической ошибки -- это значит, что алгебраический порядок точности формулы трех восьмых равен 4. По графику также была вычислена константа, равная $\approx 0,079$. Убедиться в правильности данных выводов можно сравнив линию ошибки с прямой $y=0,079H^4$ -- они визуально полностью совпадают. Линия максимальной ошибки параллельна линии фактической ошибки и соответствует прямой $y=\dfrac{(b-a)M_4}{6480}H^4=\dfrac{3,7\cdot360}{6480}H^4\approx0,206H^4$ -- выше линии фактической ошибки, что означает справедливость оценки \eqref{final_est}.
	
	\section{Выводы.}
	
	\begin{itemize}
		\item Формула трех восьмых -- квадратурная формула Ньютона-Котеса, соответствующая интерполированию подынтегральной функции кубическим полиномом на каждом отрезке разбиения.
		\item Формула трех восьмых имеет алгебраический порядок точности равный четырем.
		\item Правило Рунге дает неплохую апостериорную оценку вычисления определенного интеграла в случае, когда количество отрезков разбиения увеличивается в 2 раза (в общем случае, возможно, и в $n>2$ раз).
		\item Существуют также и теоретические оценки погрешности \eqref{theor_est}.
	\end{itemize}
	
\end{document}